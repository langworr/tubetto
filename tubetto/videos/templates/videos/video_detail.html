{% extends "base.html" %}
{% block content %}

<div class="video-player">
    {% if stream.stream_type == "hls" %}
        <!-- HLS stream -->
        <video width="100%" controls>
            <source src="{% url 'hls_manifest' video.yt_video_id %}" type="application/vnd.apple.mpegurl">
            Your browser does not support HLS video.
        </video>
    {% elif stream.stream_type == "progressive" %}
        <!-- Progressive MP4 stream -->
        <video width="100%" controls>
            <source src="{% url 'progressive_file' video.yt_video_id %}" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    {% else %}
        <p>Stream type not supported: {{ stream.stream_type }}</p>
    {% endif %}
</div>

<div class="video-info">
    <h1>{{ video.title }}</h1>
    <p>{{ video.description }}</p>
    <p><strong>Duration:</strong> {{ video.duration }} seconds</p>
</div>

<section style="margin-top: 1rem;">
  <h2>Metadata</h2>
  <table style="width:100%; max-width: 640px; border-collapse: collapse;">
    <tbody>
      <tr>
        <th style="text-align:left; padding:0.4rem;">Video ID</th>
        <td style="padding:0.4rem;">{{ video.yt_video_id }}</td>
      </tr>
      <tr>
        <th style="text-align:left; padding:0.4rem;">Duration</th>
        <td style="padding:0.4rem;">{{ video.duration_display|default:"—" }}</td>
      </tr>
      <tr>
        <th style="text-align:left; padding:0.4rem;">Upload Date</th>
        <td style="padding:0.4rem;">{{ video.upload_date|date:"Y-m-d" }}</td>
      </tr>
      <tr>
        <th style="text-align:left; padding:0.4rem;">Channel</th>
        <td style="padding:0.4rem;">
          {% if video.channel_title %}
            {{ video.channel_title }}
          {% elif video.channel %}
            {{ video.channel.title }}
          {% else %}
            —
          {% endif %}
          {% if video.channel_external_id %}
            <span style="color:#666;">({{ video.channel_external_id }})</span>
          {% endif %}
        </td>
      </tr>
      <tr>
        <th style="text-align:left; padding:0.4rem;">Uploader</th>
        <td style="padding:0.4rem;">
          {{ video.uploader|default:"—" }}
          {% if video.uploader_id %}
            <span style="color:#666;">({{ video.uploader_id }})</span>
          {% endif %}
        </td>
      </tr>
    </tbody>
  </table>
</section>

{% if video.description %}
<section style="margin-top: 1.5rem;">
  <h2>Description</h2>
  <div style="white-space: pre-wrap; border: 1px solid #eee; padding: 0.75rem; background-color: #fafafa;">
    {{ video.description }}
  </div>
</section>
{% endif %}

{% endblock %}
